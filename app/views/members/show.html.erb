<div class="row">
  <div class="col-sm">
    <h2>
      <%= @member %>
    </h2>
  </div>
  <div class="col-sm clearfix">
    <h2 class="d-inline-block align-middle float-left">
      <%= number_to_currency( @member.account.balance, unit: "Q$" ) %>
    </h2>
    <div class="d-inline-block align-middle float-right">
      <%= link_to fa("plus") + " Add Q$", new_member_account_add_money_path( @member ), class: "btn btn-lg btn-link p-1" %>
    </div>
  </div>
</div>

<hr>


<div class="row">

  <div class="col-sm">

    <% live_quizzes_groups = @member.live_quizzes_groups %>

    <% if live_quizzes_groups.any? %>
      <% [ :current, :waiting ].each do |status| %>
        <% quizzes = ( live_quizzes_groups[ status ] || [] ) %>
        <% if quizzes.any? %>
          <% quizzes.each do |quiz| %>
          <!-- <% if quiz.up? %> -->
            <p>
              <% if status == :current %>
                <h1 class="d-inline-block align-middle">
                  <%= quiz %>
                </h1>
                <%= link_to member_plays_path( @member, quiz_id: quiz.id ), method: :POST, class: "btn btn-outline-primary" do %>
                  <%= fa("futbol") %> Play
                <% end %>
              <% else %>
                <h5 class="d-inline-block align-middle">
                  <%= quiz %>
                </h5>
                <br><%= quiz.start_local.strftime("%v at %r") %> <%= quiz.league.timezone %> time
              <% end %>
            </p>
          <!-- <% end %> -->
          <% end %>
        <% end %>
      <% end %>
    <% end %>

    <% if @member.currently_playing.any? %>
      <h4>Playing</h4>
      <p>
        <% @member.currently_playing.each do |play| %>
          <%= link_to member_play_path( @member, play ), class: "btn btn-link" do %>
            <%= play.quiz %>
          <% end %>
          <br>
      <% end %>
      </p>
    <% end %>

    <% finished_playing_groups = @member.finished_playing_groups %>

    <% if finished_playing_groups.any? %>
      <h4>Played</h4>
      <% [ :current, :pending, :results, :closed ].each do |status| %>
        <% plays = ( finished_playing_groups[ status ] || [] ) %>
        <% if plays.any? %>
          <h6><i>
            <% if status == :current %>
            Completed
            <% else %>
            <%= status.to_s.titleize %>
            <% end %>
          </i></h6>
          <p>
            <% plays.each do |play| %>
              <%= link_to member_play_path( @member, play ), class: "btn btn-link" do %>
                <%= play.quiz %>
              <% end %>
              <% if play.results? %>
                <%= pluralize( play.result[:score], 'point' ) %>
              <% end %>
              <br>
          <% end %>
        </p>
        <% end %>
      <% end %>
    <% end %>

  </div>

  <div class="col-sm">

    <% published_posts = @member.league.published_posts %>

    <% if published_posts %>
      <% published_posts.each do |post| %>
      <p>
        <div class="card">
          <div class="card-body">
            <div class="float-right"><small><%= time_ago_in_words post.updated_at, vague: true %> ago</small></div>
            <h4><%= post.title %></h4>
            <hr>
            <p><%= markdown( post.body ) %></p>
          </div>
        </div>
      </p>
      <% end %>
    <% else %>
      <p><i>None</i></p>
    <% end %>

  </div>


</div>
